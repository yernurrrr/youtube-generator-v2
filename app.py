<<<<<<< HEAD
import streamlit as st
import os
from google import genai
from google.genai.errors import APIError

# --- ะะะะคะะะฃะะะฆะะฏ API ะ ะะะะะะ ---
# ะะปัั GEMINI_API_KEY ะฑัะดะตั ะฟะพะปััะตะฝ ะธะท Streamlit Secrets (ะธะปะธ ะธะท ะปะพะบะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั)
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
MODEL_NAME = "gemini-2.5-flash"

def generate_titles(prompt_text, style):
    """ะัะฟัะฐะฒะปัะตั ะทะฐะฟัะพั ะบ ะผะพะดะตะปะธ Gemini, ะฒะบะปััะฐั ะฒัะฑัะฐะฝะฝัะน ััะธะปั."""
    if not GEMINI_API_KEY:
        # ะญัะพ ัะพะพะฑัะตะฝะธะต ะฟะพะบะฐะถะตััั, ะตัะปะธ ะบะปัั ะฝะต ัััะฐะฝะพะฒะปะตะฝ ะฒ Streamlit Secrets ะธะปะธ ะปะพะบะฐะปัะฝะพ
        return "ะัะธะฑะบะฐ: ะะต ะฝะฐะนะดะตะฝ GEMINI_API_KEY. ะะพะถะฐะปัะนััะฐ, ัััะฐะฝะพะฒะธัะต ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั (ะฝะฐ SCS ะธะปะธ ะปะพะบะฐะปัะฝะพ)."

    client = genai.Client(api_key=GEMINI_API_KEY)

    # ะะฝััััะบัะธะธ (ัะธััะตะผะฝัะน ะฟัะพะผะฟั), ะบะพัะพััะต ะดะตะปะฐัั ะผะพะดะตะปั "ัะบัะฟะตััะพะผ"
    # *** ะะกะะะะฌะะฃะะ ะะซะะะ ะกะขะะะฏ ะ ะะะะะะขะ ***
    system_instruction = (
        f"ะขั ัะบัะฟะตัั ะฟะพ ัะพะทะดะฐะฝะธั ะฟัะธะฒะปะตะบะฐัะตะปัะฝัั ะธ ะบะปะธะบะฐะฑะตะปัะฝัั ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube-ะฒะธะดะตะพ. ะขะฒะพะน ััะธะปั ะดะพะปะถะตะฝ ะฑััั: '{style}'. "
        "ะัะฒะตัะฐะน ัะพะปัะบะพ ัะฟะธัะบะพะผ ะธะท 5 ัะฝะธะบะฐะปัะฝัั ะฒะฐัะธะฐะฝัะพะฒ, ะฝะต ะดะพะฑะฐะฒะปัั ะปะธัะฝะตะณะพ ัะตะบััะฐ ะธะปะธ ะบะพะผะผะตะฝัะฐัะธะตะฒ."
    )

    # ะะพะปัะทะพะฒะฐัะตะปััะบะธะน ะฟัะพะผะฟั
    full_prompt = (
        f"ะกะณะตะฝะตัะธััะน 5 ะฒะฐัะธะฐะฝัะพะฒ ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube-ะฒะธะดะตะพ ะฝะฐ ะพัะฝะพะฒะต ัะปะตะดัััะตะน ัะตะผั: '{prompt_text}'"
    )

    try:
        response = client.models.generate_content(
            model=MODEL_NAME,
            contents=full_prompt,
            config={"system_instruction": system_instruction}
        )
        return response.text
    except APIError as e:
        return f"ะัะพะธะทะพัะปะฐ ะพัะธะฑะบะฐ API: {e}"
    except Exception as e:
        return f"ะัะพะธะทะพัะปะฐ ะฝะตะฟัะตะดะฒะธะดะตะฝะฝะฐั ะพัะธะฑะบะฐ: {e}"

# --- ะะกะะะะะะฏ ะะะะะะ STREAMLIT ---

st.set_page_config(page_title="ะะตะฝะตัะฐัะพั ะะฐะณะพะปะพะฒะบะพะฒ", layout="centered")
st.title("๐ฅ ะะตะฝะตัะฐัะพั ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube (MVP)")

# 1. ะะพะปะต ะฒะฒะพะดะฐ ัะตะผั
text_input = st.text_input("ะะฒะตะดะธัะต ัะตะผั ะฒะฐัะตะณะพ ะฒะธะดะตะพ:", placeholder="ะะฐะบ ะฑััััะพ ะฒัััะธัั Python", key="topic")

# 2. ะะพะปะต ะฒัะฑะพัะฐ ััะธะปั (ะะะะซะ ะญะะะะะะข)
style_selection = st.selectbox(
    "ะัะฑะตัะธัะต ะถะตะปะฐะตะผัะน ััะธะปั ะทะฐะณะพะปะพะฒะบะพะฒ:",
    options=["ะะฝัะพัะผะฐัะธะพะฝะฝัะน", "ะะปะธะบะฑะตะนัะฝัะน (ะธะฝััะธะณัััะธะน)", "ะฎะผะพัะธััะธัะตัะบะธะน", "ะกะตััะตะทะฝัะน"],
    key="style"
)

if st.button("ะกะณะตะฝะตัะธัะพะฒะฐัั ๐"):
    if text_input:
        st.info("ะะตะฝะตัะฐัะธั... ะญัะพ ะผะพะถะตั ะทะฐะฝััั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด.")

        # *** ะะะะะะะงะ ะกะขะะะฏ ะ ะคะฃะะะฆะะฎ ***
        result_text = generate_titles(text_input, style_selection)

        # ะัะพะฑัะฐะถะตะฝะธะต ัะตะทัะปััะฐัะฐ
        st.success("โ ะะพัะพะฒะพ! ะะฐัะธ ะทะฐะณะพะปะพะฒะบะธ:")
        st.markdown(result_text)

    else:
        st.warning("ะะพะถะฐะปัะนััะฐ, ะฒะฒะตะดะธัะต ัะตะบัั ะดะปั ะณะตะฝะตัะฐัะธะธ ะทะฐะณะพะปะพะฒะบะฐ")
=======
import streamlit as st
import os
from google import genai
from google.genai.errors import APIError

# --- ะะะะคะะะฃะะะฆะะฏ API ะ ะะะะะะ ---
# ะะปัั GEMINI_API_KEY ะฑัะดะตั ะฟะพะปััะตะฝ ะธะท Streamlit Secrets (ะธะปะธ ะธะท ะปะพะบะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั)
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
MODEL_NAME = "gemini-2.5-flash"

def generate_titles(prompt_text, style):
    """ะัะฟัะฐะฒะปัะตั ะทะฐะฟัะพั ะบ ะผะพะดะตะปะธ Gemini, ะฒะบะปััะฐั ะฒัะฑัะฐะฝะฝัะน ััะธะปั."""
    if not GEMINI_API_KEY:
        # ะญัะพ ัะพะพะฑัะตะฝะธะต ะฟะพะบะฐะถะตััั, ะตัะปะธ ะบะปัั ะฝะต ัััะฐะฝะพะฒะปะตะฝ ะฒ Streamlit Secrets ะธะปะธ ะปะพะบะฐะปัะฝะพ
        return "ะัะธะฑะบะฐ: ะะต ะฝะฐะนะดะตะฝ GEMINI_API_KEY. ะะพะถะฐะปัะนััะฐ, ัััะฐะฝะพะฒะธัะต ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั (ะฝะฐ SCS ะธะปะธ ะปะพะบะฐะปัะฝะพ)."

    client = genai.Client(api_key=GEMINI_API_KEY)

    # ะะฝััััะบัะธะธ (ัะธััะตะผะฝัะน ะฟัะพะผะฟั), ะบะพัะพััะต ะดะตะปะฐัั ะผะพะดะตะปั "ัะบัะฟะตััะพะผ"
    # *** ะะกะะะะฌะะฃะะ ะะซะะะ ะกะขะะะฏ ะ ะะะะะะขะ ***
    system_instruction = (
        f"ะขั ัะบัะฟะตัั ะฟะพ ัะพะทะดะฐะฝะธั ะฟัะธะฒะปะตะบะฐัะตะปัะฝัั ะธ ะบะปะธะบะฐะฑะตะปัะฝัั ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube-ะฒะธะดะตะพ. ะขะฒะพะน ััะธะปั ะดะพะปะถะตะฝ ะฑััั: '{style}'. "
        "ะัะฒะตัะฐะน ัะพะปัะบะพ ัะฟะธัะบะพะผ ะธะท 5 ัะฝะธะบะฐะปัะฝัั ะฒะฐัะธะฐะฝัะพะฒ, ะฝะต ะดะพะฑะฐะฒะปัั ะปะธัะฝะตะณะพ ัะตะบััะฐ ะธะปะธ ะบะพะผะผะตะฝัะฐัะธะตะฒ."
    )

    # ะะพะปัะทะพะฒะฐัะตะปััะบะธะน ะฟัะพะผะฟั
    full_prompt = (
        f"ะกะณะตะฝะตัะธััะน 5 ะฒะฐัะธะฐะฝัะพะฒ ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube-ะฒะธะดะตะพ ะฝะฐ ะพัะฝะพะฒะต ัะปะตะดัััะตะน ัะตะผั: '{prompt_text}'"
    )

    try:
        response = client.models.generate_content(
            model=MODEL_NAME,
            contents=full_prompt,
            config={"system_instruction": system_instruction}
        )
        return response.text
    except APIError as e:
        return f"ะัะพะธะทะพัะปะฐ ะพัะธะฑะบะฐ API: {e}"
    except Exception as e:
        return f"ะัะพะธะทะพัะปะฐ ะฝะตะฟัะตะดะฒะธะดะตะฝะฝะฐั ะพัะธะฑะบะฐ: {e}"

# --- ะะกะะะะะะฏ ะะะะะะ STREAMLIT ---

st.set_page_config(page_title="ะะตะฝะตัะฐัะพั ะะฐะณะพะปะพะฒะบะพะฒ", layout="centered")
st.title("๐ฅ ะะตะฝะตัะฐัะพั ะทะฐะณะพะปะพะฒะบะพะฒ ะดะปั YouTube (MVP)")

# 1. ะะพะปะต ะฒะฒะพะดะฐ ัะตะผั
text_input = st.text_input("ะะฒะตะดะธัะต ัะตะผั ะฒะฐัะตะณะพ ะฒะธะดะตะพ:", placeholder="ะะฐะบ ะฑััััะพ ะฒัััะธัั Python", key="topic")

# 2. ะะพะปะต ะฒัะฑะพัะฐ ััะธะปั (ะะะะซะ ะญะะะะะะข)
style_selection = st.selectbox(
    "ะัะฑะตัะธัะต ะถะตะปะฐะตะผัะน ััะธะปั ะทะฐะณะพะปะพะฒะบะพะฒ:",
    options=["ะะฝัะพัะผะฐัะธะพะฝะฝัะน", "ะะปะธะบะฑะตะนัะฝัะน (ะธะฝััะธะณัััะธะน)", "ะฎะผะพัะธััะธัะตัะบะธะน", "ะกะตััะตะทะฝัะน"],
    key="style"
)

if st.button("ะกะณะตะฝะตัะธัะพะฒะฐัั ๐"):
    if text_input:
        st.info("ะะตะฝะตัะฐัะธั... ะญัะพ ะผะพะถะตั ะทะฐะฝััั ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด.")

        # *** ะะะะะะะงะ ะกะขะะะฏ ะ ะคะฃะะะฆะะฎ ***
        result_text = generate_titles(text_input, style_selection)

        # ะัะพะฑัะฐะถะตะฝะธะต ัะตะทัะปััะฐัะฐ
        st.success("โ ะะพัะพะฒะพ! ะะฐัะธ ะทะฐะณะพะปะพะฒะบะธ:")
        st.markdown(result_text)

    else:
        st.warning("ะะพะถะฐะปัะนััะฐ, ะฒะฒะตะดะธัะต ัะตะบัั ะดะปั ะณะตะฝะตัะฐัะธะธ ะทะฐะณะพะปะพะฒะบะฐ")

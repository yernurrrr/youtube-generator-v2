<<<<<<< HEAD
import streamlit as st
import os
from google import genai
from google.genai.errors import APIError

# --- ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð¯ API Ð˜ ÐœÐžÐ”Ð•Ð›Ð˜ ---
# ÐšÐ»ÑŽÑ‡ GEMINI_API_KEY Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ Ð¸Ð· Streamlit Secrets (Ð¸Ð»Ð¸ Ð¸Ð· Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ)
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
MODEL_NAME = "gemini-2.5-flash"

def generate_titles(prompt_text, style):
    """ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº Ð¼Ð¾Ð´ÐµÐ»Ð¸ Gemini, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ."""
    if not GEMINI_API_KEY:
        # Ð­Ñ‚Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÐ°Ð¶ÐµÑ‚ÑÑ, ÐµÑÐ»Ð¸ ÐºÐ»ÑŽÑ‡ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² Streamlit Secrets Ð¸Ð»Ð¸ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾
        return "ÐžÑˆÐ¸Ð±ÐºÐ°: ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½ GEMINI_API_KEY. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ (Ð½Ð° SCS Ð¸Ð»Ð¸ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾)."

    client = genai.Client(api_key=GEMINI_API_KEY)

    # Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ (ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð´ÐµÐ»Ð°ÑŽÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ "ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"
    # *** Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—Ð£Ð•Ðœ Ð’Ð«Ð‘ÐžÐ  Ð¡Ð¢Ð˜Ð›Ð¯ Ð’ ÐŸÐ ÐžÐœÐŸÐ¢Ð• ***
    system_instruction = (
        f"Ð¢Ñ‹ ÑÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸ÑŽ Ð¿Ñ€Ð¸Ð²Ð»ÐµÐºÐ°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¸ ÐºÐ»Ð¸ÐºÐ°Ð±ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube-Ð²Ð¸Ð´ÐµÐ¾. Ð¢Ð²Ð¾Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ: '{style}'. "
        "ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¿Ð¸ÑÐºÐ¾Ð¼ Ð¸Ð· 5 ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð², Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ Ð»Ð¸ÑˆÐ½ÐµÐ³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð° Ð¸Ð»Ð¸ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸ÐµÐ²."
    )

    # ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚
    full_prompt = (
        f"Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹ 5 Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube-Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ Ñ‚ÐµÐ¼Ñ‹: '{prompt_text}'"
    )

    try:
        response = client.models.generate_content(
            model=MODEL_NAME,
            contents=full_prompt,
            config={"system_instruction": system_instruction}
        )
        return response.text
    except APIError as e:
        return f"ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° API: {e}"
    except Exception as e:
        return f"ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°: {e}"

# --- ÐžÐ¡ÐÐžÐ’ÐÐÐ¯ Ð›ÐžÐ“Ð˜ÐšÐ STREAMLIT ---

st.set_page_config(page_title="Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²", layout="centered")
st.title("ðŸ”¥ Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube (MVP)")

# 1. ÐŸÐ¾Ð»Ðµ Ð²Ð²Ð¾Ð´Ð° Ñ‚ÐµÐ¼Ñ‹
text_input = st.text_input("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐ¼Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð¸Ð´ÐµÐ¾:", placeholder="ÐšÐ°Ðº Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð²Ñ‹ÑƒÑ‡Ð¸Ñ‚ÑŒ Python", key="topic")

# 2. ÐŸÐ¾Ð»Ðµ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÑÑ‚Ð¸Ð»Ñ (ÐÐžÐ’Ð«Ð™ Ð­Ð›Ð•ÐœÐ•ÐÐ¢)
style_selection = st.selectbox(
    "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¶ÐµÐ»Ð°ÐµÐ¼Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²:",
    options=["Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹", "ÐšÐ»Ð¸ÐºÐ±ÐµÐ¹Ñ‚Ð½Ñ‹Ð¹ (Ð¸Ð½Ñ‚Ñ€Ð¸Ð³ÑƒÑŽÑ‰Ð¸Ð¹)", "Ð®Ð¼Ð¾Ñ€Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹", "Ð¡ÐµÑ€ÑŒÐµÐ·Ð½Ñ‹Ð¹"],
    key="style"
)

if st.button("Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ðŸš€"):
    if text_input:
        st.info("Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ... Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ð½ÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑÐµÐºÑƒÐ½Ð´.")

        # *** ÐŸÐ•Ð Ð•Ð”ÐÐ§Ð Ð¡Ð¢Ð˜Ð›Ð¯ Ð’ Ð¤Ð£ÐÐšÐ¦Ð˜Ð® ***
        result_text = generate_titles(text_input, style_selection)

        # ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
        st.success("âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð’Ð°ÑˆÐ¸ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸:")
        st.markdown(result_text)

    else:
        st.warning("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ°")
=======
import streamlit as st
import os
from google import genai
from google.genai.errors import APIError

# --- ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜Ð¯ API Ð˜ ÐœÐžÐ”Ð•Ð›Ð˜ ---
# ÐšÐ»ÑŽÑ‡ GEMINI_API_KEY Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½ Ð¸Ð· Streamlit Secrets (Ð¸Ð»Ð¸ Ð¸Ð· Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ)
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
MODEL_NAME = "gemini-2.5-flash"

def generate_titles(prompt_text, style):
    """ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº Ð¼Ð¾Ð´ÐµÐ»Ð¸ Gemini, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ."""
    if not GEMINI_API_KEY:
        # Ð­Ñ‚Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÐ°Ð¶ÐµÑ‚ÑÑ, ÐµÑÐ»Ð¸ ÐºÐ»ÑŽÑ‡ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð² Streamlit Secrets Ð¸Ð»Ð¸ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾
        return "ÐžÑˆÐ¸Ð±ÐºÐ°: ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½ GEMINI_API_KEY. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ (Ð½Ð° SCS Ð¸Ð»Ð¸ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾)."

    client = genai.Client(api_key=GEMINI_API_KEY)

    # Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ (ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚), ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð´ÐµÐ»Ð°ÑŽÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ "ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"
    # *** Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—Ð£Ð•Ðœ Ð’Ð«Ð‘ÐžÐ  Ð¡Ð¢Ð˜Ð›Ð¯ Ð’ ÐŸÐ ÐžÐœÐŸÐ¢Ð• ***
    system_instruction = (
        f"Ð¢Ñ‹ ÑÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸ÑŽ Ð¿Ñ€Ð¸Ð²Ð»ÐµÐºÐ°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¸ ÐºÐ»Ð¸ÐºÐ°Ð±ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube-Ð²Ð¸Ð´ÐµÐ¾. Ð¢Ð²Ð¾Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ: '{style}'. "
        "ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¿Ð¸ÑÐºÐ¾Ð¼ Ð¸Ð· 5 ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð², Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ Ð»Ð¸ÑˆÐ½ÐµÐ³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð° Ð¸Ð»Ð¸ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸ÐµÐ²."
    )

    # ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚
    full_prompt = (
        f"Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹ 5 Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube-Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¹ Ñ‚ÐµÐ¼Ñ‹: '{prompt_text}'"
    )

    try:
        response = client.models.generate_content(
            model=MODEL_NAME,
            contents=full_prompt,
            config={"system_instruction": system_instruction}
        )
        return response.text
    except APIError as e:
        return f"ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð¾ÑˆÐ¸Ð±ÐºÐ° API: {e}"
    except Exception as e:
        return f"ÐŸÑ€Ð¾Ð¸Ð·Ð¾ÑˆÐ»Ð° Ð½ÐµÐ¿Ñ€ÐµÐ´Ð²Ð¸Ð´ÐµÐ½Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°: {e}"

# --- ÐžÐ¡ÐÐžÐ’ÐÐÐ¯ Ð›ÐžÐ“Ð˜ÐšÐ STREAMLIT ---

st.set_page_config(page_title="Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²", layout="centered")
st.title("ðŸ”¥ Ð“ÐµÐ½ÐµÑ€Ð°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð² Ð´Ð»Ñ YouTube (MVP)")

# 1. ÐŸÐ¾Ð»Ðµ Ð²Ð²Ð¾Ð´Ð° Ñ‚ÐµÐ¼Ñ‹
text_input = st.text_input("Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐ¼Ñƒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð¸Ð´ÐµÐ¾:", placeholder="ÐšÐ°Ðº Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð²Ñ‹ÑƒÑ‡Ð¸Ñ‚ÑŒ Python", key="topic")

# 2. ÐŸÐ¾Ð»Ðµ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÑÑ‚Ð¸Ð»Ñ (ÐÐžÐ’Ð«Ð™ Ð­Ð›Ð•ÐœÐ•ÐÐ¢)
style_selection = st.selectbox(
    "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¶ÐµÐ»Ð°ÐµÐ¼Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¾Ð²:",
    options=["Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹", "ÐšÐ»Ð¸ÐºÐ±ÐµÐ¹Ñ‚Ð½Ñ‹Ð¹ (Ð¸Ð½Ñ‚Ñ€Ð¸Ð³ÑƒÑŽÑ‰Ð¸Ð¹)", "Ð®Ð¼Ð¾Ñ€Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹", "Ð¡ÐµÑ€ÑŒÐµÐ·Ð½Ñ‹Ð¹"],
    key="style"
)

if st.button("Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ðŸš€"):
    if text_input:
        st.info("Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ... Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ð½ÑÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑÐµÐºÑƒÐ½Ð´.")

        # *** ÐŸÐ•Ð Ð•Ð”ÐÐ§Ð Ð¡Ð¢Ð˜Ð›Ð¯ Ð’ Ð¤Ð£ÐÐšÐ¦Ð˜Ð® ***
        result_text = generate_titles(text_input, style_selection)

        # ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°
        st.success("âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð’Ð°ÑˆÐ¸ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸:")
        st.markdown(result_text)

    else:
        st.warning("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ°")
>>>>>>> 37306796beccb38b7347c62b4d74aa01666c581f
